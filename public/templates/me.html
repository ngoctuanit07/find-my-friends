<ion-view title="Me">
    <ion-nav-buttons side="right">
        <button ng-click="logOut()" class="button button-clear icon-right ion-log-out">Logout</button>
    </ion-nav-buttons>
    <ion-content has-header="true" padding="true">

        <div class="list" ng-show="address">
            <div class="item item-divider">
                My last address location
            </div>
            <a class="item item-icon-left"
               target="_blank"
               href="{{address.url}}">
                <i class="icon ion-android-location"></i>
                {{address.text}}
            </a>
            <a class="item item-icon-left"
               target="_blank"
               href="{{address.url}}">
                <i class="icon ion-android-timer"></i>
                {{timeSince(user.location.updated.date)}}
            </a>
            <a class="item item-icon-left"
               target="_blank"
               href="{{address.url}}">
                <i class="icon ion-android-locate"></i>
                Accuracy: {{user.location.accuracy | number:2}} meters
            </a>
        </div>

        <!------------- PENDING CONFIRMATION --------------->
        <div ng-show="pendingFriends.length">
            <div class="item item-divider">
                Pending friendship requests
            </div>
            <div class="list">
                <a ng-repeat="friend in pendingFriends = ( friends | filter:{status:'pending_confirmation'}:true )"
                   class="item item-avatar item-button-right" href="#/friend/{{friend.user.id}}">
                    <img ng-src="{{friend.user.photo}}">
                    <h2>{{friend.user.name}}</h2>
                    <div class="buttons">
                        <button class="button button-balanced"
                                ng-click="acceptFriendRequest({{friend.user.id}})"
                                prevent-default>
                            <i class="ion-checkmark"></i>
                        </button>
                        <button class="button button-assertive"
                                ng-click="declineFriendRequest({{friend.user.id}})"
                                prevent-default>
                            <i class="ion-close"></i>
                        </button>
                    </div>
                </a>
            </div>
        </div>

        <!------------- SHARING --------------->
        <div ng-show="sharingFriends.length">
            <div class="item item-divider">
                Sharing location with
            </div>
            <div class="list">
                <a ng-repeat="friend in sharingFriends = ( friends | filter:{status:'sharing'}:true )"
                   class="item item-avatar item-button-right" href="#/friend/{{friend.user.id}}">
                    <img ng-src="{{friend.user.photo}}">
                    <h2>{{friend.user.name}}</h2>
                    <button class="button button-assertive"
                            ng-click="stopSharingLocation({{friend.user.id}})"
                            prevent-default>Stop</button>
                </a>
            </div>
        </div>

        <!------------- NOT SHARING --------------->
        <div ng-show="notSharingFriends.length">
            <div class="item item-divider">
                Share your location with
            </div>
            <div class="list">
                <a ng-repeat="friend in notSharingFriends = ( friends | filter:{status:'not_sharing'}:true )"
                   class="item item-avatar item-button-right" href="#/friend/{{friend.user.id}}">
                    <img ng-src="{{friend.user.photo}}">
                    <h2>{{friend.user.name}}</h2>
                    <button class="button button-positive"
                            ng-click="startSharingLocation({{friend.user.id}})"
                            prevent-default>Share</button>
                </a>
            </div>
        </div>

        <!------------- BLOCKED --------------->
        <div ng-show="blockedFriends.length">
            <div class="item item-divider">
                Blocked contacts
            </div>
            <div class="list">
                <a ng-repeat="friend in blockedFriends = ( friends | filter:{status:'blocked'}:true )"
                   class="item item-avatar item-button-right" href="#/friend/{{friend.user.id}}">
                    <img ng-src="{{friend.user.photo}}">
                    <h2>{{friend.user.name}}</h2>
                    <button class="button button-balanced"
                            ng-click="unblockFriend({{friend.user.id}})"
                            prevent-default>Unblock</button>
                </a>
            </div>
        </div>

        <!------------- SENT REQUESTS --------------->
        <div ng-show="invitedFriends.length">
            <div class="item item-divider">
                Sent friendship requests
            </div>
            <div class="list">
                <a ng-repeat="friend in invitedFriends = ( friends | filter:{status:'sent_request'}:true )"
                   class="item item-avatar item-button-right" href="#/friend/{{friend.user.id}}">
                    <img ng-src="{{friend.user.photo}}">
                    <h2>{{friend.user.name}}</h2>
                    <button class="button button-stable" disabled
                            prevent-default>Invited</button>
                </a>
            </div>
        </div>

    </ion-content>
</ion-view>
